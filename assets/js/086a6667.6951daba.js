"use strict";(self.webpackChunkwrangling=self.webpackChunkwrangling||[]).push([[2670],{3905:(e,t,a)=>{a.d(t,{Zo:()=>m,kt:()=>c});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),l=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},m=function(e){var t=l(e.components);return n.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),d=l(a),c=r,h=d["".concat(p,".").concat(c)]||d[c]||u[c]||i;return a?n.createElement(h,o(o({ref:t},m),{},{components:a})):n.createElement(h,o({ref:t},m))}));function c(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=d;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var l=2;l<i;l++)o[l]=a[l];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},2905:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var n=a(7462),r=(a(7294),a(3905));const i={title:"Assignment 6"},o=void 0,s={unversionedId:"modules/apis/assignment",id:"modules/apis/assignment",title:"Assignment 6",description:"Building an API Client for US Census data",source:"@site/docs/modules/apis/assignment.md",sourceDirName:"modules/apis",slug:"/modules/apis/assignment",permalink:"/modules/apis/assignment",draft:!1,editUrl:"https://github.com/wustl-data/wustl-data.github.io/edit/main/docs/modules/apis/assignment.md",tags:[],version:"current",frontMatter:{title:"Assignment 6"},sidebar:"docSidebar",previous:{title:"Assignment 4",permalink:"/modules/testing/Assignment 4"},next:{title:"2nd half overview",permalink:"/modules/tools/"}},p={},l=[{value:"Building an API Client for US Census data",id:"building-an-api-client-for-us-census-data",level:2},{value:"Due: 11/29, 5:00 PM",id:"due-1129-500-pm",level:3},{value:"GitHub Classroom Link",id:"github-classroom-link",level:4}],m={toc:l};function u(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"building-an-api-client-for-us-census-data"},"Building an API Client for US Census data"),(0,r.kt)("h3",{id:"due-1129-500-pm"},"Due: 11/29, 5:00 PM"),(0,r.kt)("h4",{id:"github-classroom-link"},(0,r.kt)("a",{parentName:"h4",href:"https://classroom.github.com/a/bISSMHjc"},"GitHub Classroom Link")),(0,r.kt)("p",null,"Use the following resources to familiarize yourself with the US Census Web API. Browse/skim these resources and use them as a reference as needed:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"The ",(0,r.kt)("a",{parentName:"p",href:"https://www.census.gov/data/developers/guidance/api-user-guide.Example_API_Queries.html"},"Census API User Guide"),". "),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Full PDF guide"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"Example API Queries")," tab/section, ",(0,r.kt)("strong",{parentName:"li"},"Population Estimates Example"),". Steps 1-7 give a basic overview of the API syntax. "))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"The base endpoint of the dataset at ",(0,r.kt)("a",{parentName:"p",href:"https://api.census.gov/data/2019/pep/charagegroups"},"https://api.census.gov/data/2019/pep/charagegroups")),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"sub-endpoints such as ",(0,r.kt)("a",{parentName:"li",href:"https://api.census.gov/data/2019/pep/charagegroups/variables.json"},"https://api.census.gov/data/2019/pep/charagegroups/variables.json")," (navigable from the dataset endpoint)")))),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"This assignment introduces MyPy type checking. In the last module you were introduced to ",(0,r.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/typing.html"},(0,r.kt)("em",{parentName:"a"},"type hints"))," as a non-binding way to specify the type of a function's argument or its output type. ",(0,r.kt)("a",{parentName:"p",href:"https://mypy.readthedocs.io/en/stable/index.html"},"Mypy")," is a tool can check your code for type errors before you run it. Type hints and type classes are provided here to help convey the specifications of the assignment. The default VS code settings in your Codespaces should provide type checks during linting. If you would like manually to check your code using the mypy type checker, run it with ",(0,r.kt)("inlineCode",{parentName:"p"},"mypy <file/dir/wildcard>")," /  in your terminal.")),(0,r.kt)("p",null,"Use the API documentation, test specifications, docstrings, and type hints to guide your implementations. "),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Base URL")," (10 points)\nImplement the function ",(0,r.kt)("inlineCode",{parentName:"p"},"endpoint")," to construct a base URL for the US Census API for a given year and dataset. ")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Variables")," (10 points)\nImplement the function ",(0,r.kt)("inlineCode",{parentName:"p"},"variables")," to convert a list of census variables into a comma separated string of the values.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Variable Predicates")," (10 points)\nImplement the function ",(0,r.kt)("inlineCode",{parentName:"p"},"convert_values")," to convert a dictionary of ",(0,r.kt)("inlineCode",{parentName:"p"},"variable: values")," into a dictionary of ",(0,r.kt)("inlineCode",{parentName:"p"},"variable: value_ids")," for the categorical variables HISP and SEX."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},":::tip\n\nUse the documentation to find the mapping of categorical variable names to integers.\n\n:::\n")))),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"State Geographies")," (10 points)"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Implement the function ",(0,r.kt)("inlineCode",{parentName:"p"},"geographies")," that converts a list of state abbreviations to a string of comma-separated FIPS codes. "),(0,r.kt)("p",{parentName:"li"},"  :::tip"),(0,r.kt)("p",{parentName:"li"},"  The ",(0,r.kt)("inlineCode",{parentName:"p"},"us")," module is installed on your Codespace/devcontainer. Find its documentation for a convenient conversion function."),(0,r.kt)("p",{parentName:"li"},"  :::"))))),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"County FIPS codes")," (10 points)"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"County-level FIPS codes may be found at ",(0,r.kt)("a",{parentName:"p",href:"https://www.census.gov/library/reference/code-lists/ansi.html#county"},"https://www.census.gov/library/reference/code-lists/ansi.html#county"),". However, programmatic access to this data will need an outside-the-box approach since the codes are hidden behind a dropdown menu. Inspect a few URLs of the county FIPS codes from different states, then create a function that returns a DataFrame of the county-level FIPS data from a state FIPS code."),(0,r.kt)("p",{parentName:"li"},"  :::tip"),(0,r.kt)("p",{parentName:"li"},"  ",(0,r.kt)("inlineCode",{parentName:"p"},"pandas.read_csv")," can take a URL argument as input."),(0,r.kt)("p",{parentName:"li"},"  :::")))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Implement API Client function")," (30 points) "),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Browse the Census API docs and determine where you may apply for an API key, and do so. Add a (text) file named ",(0,r.kt)("inlineCode",{parentName:"li"},".env")," to the root of your repository and add your API key as such:")),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre"},"CENSUS_API_KEY=<yourkeyhere>\n")),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Add your ",(0,r.kt)("inlineCode",{parentName:"p"},".env")," file to your ",(0,r.kt)("inlineCode",{parentName:"p"},".gitignore")," so that others may not take advantage of your API key.        ")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Install ",(0,r.kt)("inlineCode",{parentName:"p"},"python-dotenv")," using Poetry and use the library to read your API key from your .env into an ",(0,r.kt)("em",{parentName:"p"},"environment variable"),".")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Use ",(0,r.kt)("inlineCode",{parentName:"p"},"os.environ")," to load the value from the ",(0,r.kt)("em",{parentName:"p"},"environment variable")," into your code.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Optional: Modify the provided test for ",(0,r.kt)("inlineCode",{parentName:"p"},"census.get")," to use your API key."),(0,r.kt)("p",{parentName:"li"},"  :::info"),(0,r.kt)("p",{parentName:"li"},"  The Census API allows for a certain number of queries per day per IP address as described in their docs. The autograder will be provided with its own API key (set via environment variable) , thus it must use an API key to avoid this limit and so must your implementations."),(0,r.kt)("p",{parentName:"li"},"  :::")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Implement the function ",(0,r.kt)("inlineCode",{parentName:"p"},"client.get")," to retrieve data from the Census API using your API key.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Use the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.python-requests.org/en/latest/"},"requests")," package to make your API call inside the body of your function. "),(0,r.kt)("p",{parentName:"li"},"  :::tip"),(0,r.kt)("p",{parentName:"li"},"  Utilize your functions from the previous steps to appropriate handle the arguments to your function and provide them to ",(0,r.kt)("inlineCode",{parentName:"p"},"requests.get"),". You should modify ",(0,r.kt)("inlineCode",{parentName:"p"},"geographies")," to handle counties similarly to how you handled states."),(0,r.kt)("p",{parentName:"li"},"  :::"),(0,r.kt)("p",{parentName:"li"},"  :::warning Correction"),(0,r.kt)("p",{parentName:"li"},"  The type hint for the ",(0,r.kt)("inlineCode",{parentName:"p"},"geos")," argument to ",(0,r.kt)("inlineCode",{parentName:"p"},"get")," was incorrectly given in the starter code as: "),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"dict[str, dict[str, list[str]]],\n")),(0,r.kt)("p",{parentName:"li"},"  The type hint should be:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-python"},"dict[str, list[str]],\n")),(0,r.kt)("p",{parentName:"li"},"  It is also incorrectly listed as ",(0,r.kt)("inlineCode",{parentName:"p"},"geographies")," in the docstring."),(0,r.kt)("p",{parentName:"li"},"  :::")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Your function should return a DataFrame of the data returned by the API."))))),(0,r.kt)("ol",{start:7},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Data verification")," (20 points)"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"To test that your API key is working properly (without sharing it with me!), write a function that uses the internal Python function ",(0,r.kt)("inlineCode",{parentName:"p"},"time.time_ns()")," to seed a Faker instance. Use this instance to generate ten random integers from 1 to 50 and use these values as FIPS codes to make a query for all counties in these states and save the output to a file named ",(0,r.kt)("inlineCode",{parentName:"p"},"<your seed value>.csv")," in your root directory. Run this function from a Python shell or notebook and include the file in your submission."),(0,r.kt)("p",{parentName:"li"},"  :::tip"),(0,r.kt)("p",{parentName:"li"},"  You may use the asterisk operator as described in the Census API docs to implement this function without retrieving county-level FIPS codes."),(0,r.kt)("p",{parentName:"li"},"  :::"))))))}u.isMDXComponent=!0}}]);